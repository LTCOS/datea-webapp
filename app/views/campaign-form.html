<nav class="navbar navbar-default campaign-form-nav" ng-class="{fix: fixMenu}">
	<div class="container-fluid">
		<ul class="nav navbar-nav">
			<li du-scrollspy="spy-step1" offset="200"><a href="#spy-step1" ng-click="scrollTo($event, 'spy-step1', 125)">Configuración general</a></li>
			<li du-scrollspy="spy-step2" offset="200"><a href="#spy-step2" ng-click="scrollTo($event, 'spy-step2', 120)">etiquetas</a></li>
			<li du-scrollspy="spy-step3" offset="200"><a href="#spy-step3" ng-click="scrollTo($event, 'spy-step3', 120)">opciones de ubicación</a></li>
			<li du-scrollspy="spy-step4" offset="200"><a href="#spy-step4" ng-click="scrollTo($event, 'spy-step4', 120)">opciones de visualización</a></li>
		</ul>
		<div class="navbar-right">
			<button class="btn btn-link btn-default">cancelar</button>
			<button class="btn btn-lg btn-primary" ng-click="flow.save()">guardar</button>
		</div>
	</div>
</nav>

<div class="container campaign-form-container" ng-class="{fix: fixMenu, 'datea-loading': loading}">
	<form class="form new-campaign-holder">
		<div class="row">
			<div class="col-xs-8">
				<div class="section" id="spy-step1">
					<h4>Configuración general</h4>
					<div class="form-group">
						<label for="title">Título</label>
						<input type="text" class="form-control" id="title" ng-model="campaign.name">
					</div>
					<div class="form-group" ng-class="{null: '',true: 'has-success has-feedback',false: 'has-error has-feedback'}[flow.validInput.mainTag]">
						<label for="main-hashtag">Etiqueta (hashtag) principal</label>
						<div class="input-group">
							<span class="input-group-addon">#</span>
							<input type="text" class="form-control" id="main-hashtag" ng-model="campaign.main_tag.tag" ng-blur="flow.checkMainTag()">
						</div>
						<span class="glyphicon form-control-feedback" ng-class="{null: '',true: 'glyphicon-ok',false: 'glyphicon-remove'}[flow.validInput.mainTag]"></span>
						<p class="help-block">{{ flow.messages.mainTagExists }}</p>
					</div>
					<div class="checkbox">
						<label>
							<input type="checkbox" ng-model="campaign.published"> Publicado
	    			</label>
	  			</div>
					<div class="form-group part part-1">
						<label>Imágen (opcional)</label>
						<div>
						<label for="image" class="datea-custom-imgUL">
							<input class="img-file-input" type="file" id="image" fileread="flow.img" filedata="flow.imgData" accept="image/*" ng-hide="flow.img">
							<img class="uploaded-img" ng-show="flow.img" ng-src="{{flow.img}}" alt="{{flow.imgData.name}}" width="300px">
						</label>
						</div>
					</div>

					<div class="form-group">
						<label for="datepicker">Fecha de finalización (opcional)</label>
						<input type="text" class="form-control" id="datepicker" ng-model="flow.dt" is-open="flow.opened" min="flow.minDate" max="'2021-06-22'" datepicker-options="flow.dateOptions" date-disabled="flow.disabled(date, mode)" ng-required="true" close-text="Cerrar">
					</div>
					<div class="form-group">
						<label for="short-description">Descripción corta (max 140 caracteres)</label>
						<textarea id="short-description" class="form-control" msd-elastic="\n" rows="1" ng-model="campaign.short_description"></textarea>
					</div>
					<div class="form-group">
						<label for="mission">Misión / Objetivos</label>
						<textarea id="mission" class="form-control" msd-elastic="\n" rows="3" ng-model="campaign.mission"></textarea>
					</div>
					<div class="form-group">
						<label for="information-destiny">¿Qué sucede con la información recibida?</label>
						<textarea id="information-destiny" class="form-control" msd-elastic="\n" rows="3" ng-model="campaign.information_destiny"></textarea>
					</div>
				</div>
				<hr>
				<div class="form-group">
					<label for="categories">Categoria General</label>
						<select class="form-control" ng-model="flow.selectedCategory" ng-options="category.id as category.name for category in flow.categories">
					</select>
				</div>
				<div class="section" id="spy-step2">
					<h4>Etiquetas (hashtags)</h4>
					<div class="form-group">
						<label for="new-tag">Introduce una etiqueta y agregalas una por una</label>
						<div class="input-group col-sm-6">
							<input type="text" ng-model="flow.nextTag" class="form-control">
							<span class="input-group-btn">
								<button class="btn btn-default" type="button" ng-click="flow.addTag()">+</button>
							</span>
						</div>
					</div>
					<div class="well">
						<h5>Etiquetas seleccionadas</h5>
						<ul class="tags-holder">
							<li class="tag-holder" ng-repeat="tag in campaign.secondary_tags">
								<div class="arrows part part-1">
									<i class="fa fa-caret-square-o-up" ng-click="flow.arrowUp($index)"></i>
									<i class="fa fa-caret-square-o-down" ng-click="flow.arrowDown($index)"></i>
								</div>
								<!--<div class="title part part-2">
									{{tag.title}}
								</div>-->
								<div class="tag part part-3">
									#{{tag.tag}}
								</div>
								<div class="close part part-4" ng-click="flow.removeTag($index)">
									[x]
								</div>
							</li>
						</ul>
					</div>
				</div>
				<hr>
				<div class="section" id="spy-step3">
					<h4>Opciones de ubicación</h4>
					<leaflet id="leafletNewCampaign" defaults="flow.leaflet.defaults" center="flow.leaflet.center" controls="flow.leaflet.controls" height="500px" width="100%"></leaflet>
		
					<hr>

					<h4>Adjuntos</h4>
					<div class="form-group part part-1">
						<label for="newFile">Suba un archivo kml o geoJSON</label>
						<input type="file" id="newFile" class="datea-custom-fileUL" fileread="flow.nextFile" filedata="flow.nextFileData" accept=".kml,.json">
					</div>
					<div class="well">
						<!-- <h6>{{newCampaign.nextFileData.name}}</h6> -->
						<ul class="files-holder">
							<li class="file-holder" ng-repeat="file in flow.leaflet.fileLayers">
								<div class="title part part-2">
									{{file.name}}
								</div>
								<div class="close part part-4" ng-click="flow.removeFile($index)">
									[x]
								</div>
							</li>
						</ul>
					</div>
				</div>
				<hr>
				<div class="section" id="spy-step4">
					<h4>Opciones de visualización</h4>
					<div class="form-group">
						<label>Visualización por defecto</label>
						<div>
							<label class="radio-inline">
								<input type="radio" ng-model="campaign.default_vis" name="default_vis" value="map"> Mapa
							</label>
							<label class="radio-inline">
								<input type="radio" ng-model="campaign.default_vis" name="default_vis" value="timeline"> Línea de tiempo
							</label>
							<label class="radio-inline">
								<input type="radio" ng-model="campaign.default_vis" name="default_vis" value="images"> Imágenes
							</label>
							<label class="radio-inline">
								<input type="radio" ng-model="campaign.default_vis" name="default_vis" value="files"> Archivos
							</label>
						</div>
					</div>

					<div class="checkbox">
						<label>
							<input type="checkbox" ng-model="campaign.default_filter" ng-true-value="owner"> Por defecto sólo ver dateos propios o redateados por mi (el usuario puede quitar el filtro)
						</label>
					</div>
				</div>
			</div>
		</div>
	</form>
</div>
